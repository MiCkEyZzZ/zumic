# Contributing

Спасибо, что хотите помочь развитию Zumic! Этот документ описывает
практики, правила и процесс внесения изменений — от простого
исправления опечатки до крупных архитектурных предложений.

---

## Коротко - суть

- Прежде чем писать большой фичер, **создайте issue** с описанием идеи
  и use-cases: это сэкономит ваше и наше время.
- Для мелких правок — делайте форк, ветку, PR; добавляйте тесты и
  запускайте `cargo test`.
- Соблюдайте форматирование (`rustfmt`) и правила линтера (`clippy`).
- Все PR проходят код-ревью и CI (unit tests, property tests, fuzzing,
  static checks).

---

## Лицензирование и Contributor Agreement (важно)

Чтобы ясно определить правовой статус вкладов, **внося код в
репозиторий Zumic**, вы соглашаетесь с условиями лицензии проекта и
(при необходимости) с Contributor License Agreement (CLA), если он/она
применим(а).

> **Простой формулировка (для включения в CONTRIBUTING):**
> Внося вклад в проект Zumic (код, документация или иное оригинальное
авторское произведение), вы сохраняете за собой все права на ваш вклад,
но предоставляете проекту Zumic бессрочную, мировую, неисключительную,
безвозмездную и отзывную/неотзывную (в зависимости от выбранной практики)
лицензию на использование, распространение и изменение вашего вклада.
>
> **Важно:** если вы хотите, чтобы ваш вклад принимался в проект,
прочитайте `LICENSE` и `CONTRIBUTOR_LICENSE.md` (если он есть). Если
вы не согласны с условиями — пожалуйста, не присылайте PR.

> _Примечание:_ этот раздел носит информативный характер. Для юридически
значимых формулировок добавьте отдельный `CONTRIBUTOR_LICENSE.md` и/или
используйте CLA-бота. При необходимости могу помочь подготовить текст
или шаблон CLA, но за юридическую корректность советую обратиться к
юристу.

---

## Как сообщать об ошибке (Issue)

Используйте GitHub Issues для:
- баг-репортов с **репродуцируемым** шагом;
- детализированных feature-requests (опишите бизнес-кейсы, ожидаемое
  поведение, возможные альтернативы).

**Что указывать в баг-репорте:**

1. Версию Zumic (`cargo --version` / git commit).
2. Операционная система / окружение.
3. Шаги воспроизведения.
4. Ожидаемое поведение и фактическое поведение.
5. Логи, backtrace или минимальный воспроизводимый пример.

Для общих вопросов/поддержки используйте каналы сообщества (Пачка /
StackOverflow / forum — опиши, куда люди должны обращаться).

---

## Как предлагать новую фичу

1. Создайте issue с описанием: цель, варианты использования,
   backward-compat вопросы, API-идея.
2. Обсудите подход, дождитесь ACK от мейнтейнеров (если фича крупная).
3. После согласования — делайте форк → ветку → PR с реализацией.

---

## Как сделать Pull Request (PR)
1. Форкните репозиторий и создайте тему ветки:
   ```zsh
   git checkout -b feat/my-feature
   ```
2. Пишите код, добавляйте тесты и документацию (если требуется).
3. Запустите локально:
  ```zsh
    cargo fmt
    cargo clippy --all-targets -- -D warnings
    cargo test
    cargo nextest run   # если в проекте используется nextest
    ./scripts/run_fuzz.sh  # при необходимости
    # либо можно использовать команды из Makefile-а.
  ```
4. Сделайте аккуратные коммиты. Следуйте соглашениям вида:
  ```zsh
    feat(engine): add dispatcher sharding
    fix(database): correct integer parsing for negative values
    docs: update README for snapshot format
  ```
5. Создайте Pull Request на GitHub, в описании укажите:

- что делает PR;
- тесты/benchmarks;
- backward compatibility;
- готовность к ревью (WIP / Ready);
6. В PR-описании поставьте чек-лист:

- [ ] Код отформатирован (`rustfmt`);
- [ ] `clippy` чист (no warnings);
- [ ] Тесты добавлены/обновлены;
- [ ] Документация обновлена (если нужно);
- [ ] CI проходит;

## Код-стайл и инструменты

- Форматирование: `rustfmt` (не настраивайте против общепринятого
  `rustfmt.toml` в репо).
- Линтинг: `clippy` с профилем проекта (`clippy.toml` / `deny.toml`).
- Тесты: `cargo test` и `cargo nextest run` (project uses nextest).
- Fuzz: `fuzz/` + `cargo-fuzz` — проверки для декодеров и критичных
  парсеров.
- CI: PR должен проходить все workflow (`dev-build`, `property-tests`,
  `fuzz` и т.д.).

## Тесты, метрики и производительность

- Для каждого изменения, влияющего на производительность — приложите
  benchmark (criterion / cargo bench) и краткое сравнение.
- Для структур данных/движка — добавьте stress tests в `tests/stress/`.
- Для изменений формата на диске — добавьте тесты совместимости версий
  (`fuzz/version_compatibility.rs` как пример).

## Security / уязвимости

Если вы обнаружили уязвимость — не публикуйте её в issue. Следуйте
`SECURITY.md` (есть в репо): напишите на конфиденциальный контакт
(email/секретный канал), опишите, как воспроизвести, и подождите
инструкции от мейнтейнеров.
